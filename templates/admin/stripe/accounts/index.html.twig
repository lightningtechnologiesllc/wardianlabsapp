{% extends 'admin/base.html.twig' %}

{% block title %}Stripe Accounts{% endblock %}

{% block body %}

<div class="min-h-full">
    <div class="bg-indigo-600 pb-32 dark:bg-indigo-800">
        {% include 'admin/_menus/top_bar.html.twig' %}
        <header class="py-10">
            <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
                <h1 class="text-3xl font-bold tracking-tight text-white">Connected Stripe Accounts</h1>
            </div>
        </header>
    </div>

    <main class="-mt-32">
        <div class="mx-auto max-w-7xl px-4 pb-12 sm:px-6 lg:px-8">
            <div class="rounded-lg bg-white px-5 py-6 shadow-sm sm:px-6 dark:bg-gray-800 dark:shadow-none dark:outline-1 dark:-outline-offset-1 dark:outline-white/10">
                <ul role="list" class="divide-y divide-gray-100 dark:divide-white/5">
                    {% for stripeAccount in stripeAccounts %}
                    <li class="flex items-center justify-between gap-x-6 py-5 px-12" data-controller="confirm-dialog">
                        <div class="flex min-w-0 gap-x-4">
                            <div class="min-w-0 flex-auto">
                                <p class="text-sm/6 font-semibold text-gray-900 dark:text-white">{{ stripeAccount.displayName }}</p>
                                <p class="mt-1 truncate text-xs/5 text-gray-500 dark:text-gray-400">{{ stripeAccount.stripeProviderAccountId }}</p>
                            </div>
                        </div>
                        <div class="flex flex-none items-center gap-x-4">
                            <a href="#" class="hidden rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-xs inset-ring inset-ring-gray-300 hover:bg-gray-50 sm:block dark:bg-white/10 dark:text-white dark:shadow-none dark:inset-ring-white/5 dark:hover:bg-white/20">
                                View Account<span class="sr-only">, {{ stripeAccount.displayName }}</span></a>

                            <el-dropdown class="relative flex-none">
                                <button class="relative block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white">
                                    <span class="absolute -inset-2.5"></span>
                                    <span class="sr-only">Open options</span>
                                    <svg viewBox="0 0 20 20" fill="currentColor" data-slot="icon" aria-hidden="true" class="size-5">
                                        <path d="M10 3a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM10 8.5a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM11.5 15.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0Z" />
                                    </svg>
                                </button>
                                <el-menu anchor="bottom end" popover class="w-32 origin-top-right rounded-md bg-white py-2 shadow-lg outline outline-gray-900/5 transition transition-discrete [--anchor-gap:--spacing(2)] data-closed:scale-95 data-closed:transform data-closed:opacity-0 data-enter:duration-100 data-enter:ease-out data-leave:duration-75 data-leave:ease-in dark:bg-gray-800 dark:shadow-none dark:-outline-offset-1 dark:outline-white/10">
                                    <button type="button" data-action="confirm-dialog#open" class="block w-full text-left px-3 py-1 text-sm/6 text-gray-900 focus:bg-gray-50 focus:outline-hidden dark:text-white dark:focus:bg-white/5">Delete<span class="sr-only">, {{ stripeAccount.displayName }}</span></button>
                                </el-menu>
                            </el-dropdown>
                        </div>

                        <!-- Delete Confirmation Dialog -->
                        <dialog data-confirm-dialog-target="dialog" data-action="click->confirm-dialog#clickOutside" class="backdrop:bg-gray-900/50 backdrop:backdrop-blur-sm rounded-lg bg-white shadow-xl dark:bg-gray-800 dark:shadow-none dark:outline dark:outline-1 dark:-outline-offset-1 dark:outline-white/10 fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 m-0 max-w-lg w-full">
                            <div class="px-6 py-6 sm:px-8 sm:py-8">
                                <div class="sm:flex sm:items-start">
                                    <div class="mx-auto flex size-12 shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:size-10 dark:bg-red-900/20">
                                        <svg class="size-6 text-red-600 dark:text-red-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z" />
                                        </svg>
                                    </div>
                                    <div class="mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left">
                                        <h3 class="text-base font-semibold text-gray-900 dark:text-white">Delete Stripe Account</h3>
                                        <div class="mt-2">
                                            <p class="text-sm text-gray-500 dark:text-gray-400">
                                                Are you sure you want to delete the Stripe account "<strong>{{ stripeAccount.displayName }}</strong>"? This action cannot be undone.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-5 sm:mt-4 sm:flex sm:flex-row-reverse gap-3">
                                    <a href="{{ path('admin_stripe_delete_account', {id: stripeAccount.accountId.value}) }}"
                                       class="inline-flex w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 sm:w-auto dark:bg-red-500 dark:hover:bg-red-400">
                                        Delete
                                    </a>
                                    <button type="button" data-action="confirm-dialog#close" class="mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto dark:bg-gray-700 dark:text-white dark:ring-gray-600 dark:hover:bg-gray-600">
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </dialog>
                    </li>
                    {% endfor %}

                    {% if stripeAccounts is empty %}
                    <div class="flex border-t border-gray-100 pt-6 dark:border-white/5">
                        <a href="{{ stripe_app_installation_link }}"
                                class="text-sm/6 font-semibold text-indigo-600 hover:text-indigo-500 dark:text-indigo-400 dark:hover:text-indigo-300">
                            <span aria-hidden="true">+</span>
                            Add Stripe Account
                        </a>
                    </div>
                    {% endif %}
                </ul>
            </div>
        </div>
    </main>
</div>
{% endblock %}
