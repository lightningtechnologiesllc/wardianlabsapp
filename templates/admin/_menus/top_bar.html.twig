{% if is_granted('IS_IMPERSONATOR') %}
<div class="bg-red-600 text-white text-center py-3 text-base font-bold shadow-lg">
    <svg class="inline-block w-5 h-5 mr-2 -mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
    </svg>
    You are impersonating: {{ app.user.username }}
    <a href="{{ impersonation_exit_path(path('admin_home')) }}" class="ml-4 inline-block bg-white text-red-600 px-4 py-1 rounded font-bold hover:bg-red-100 transition-colors">
        Exit Impersonation
    </a>
</div>
{% endif %}

<nav class="border-b border-indigo-300/25 bg-indigo-600 lg:border-none dark:border-indigo-400/25 dark:bg-indigo-800">
    <div class="mx-auto max-w-7xl px-2 sm:px-4 lg:px-8">
        <div class="relative flex h-16 items-center justify-between lg:border-b lg:border-indigo-400/25 dark:lg:border-indigo-400/25">
            <div class="flex items-center px-2 lg:px-0">
                <div class="shrink-0">
                    <img src="/favicon.svg" alt="WardianLabs" class="block size-8" />
                </div>

                {% macro menu_section_link(current_menu_section, link_section, menu_url, link_text) %}
                    {% set is_current_section = current_menu_section == link_section %}
                    <a class="admin-menu-section-link {% if is_current_section %}admin-menu-section-link-active{% else %}admin-menu-section-link-inactive{% endif %}"
                       {% if is_current_section %}
                           aria-current="page"
                       {% endif %}
                       href="{{ url(menu_url) }}">{{ link_text }}</a>
                {% endmacro %}

                <div class="hidden lg:ml-10 lg:block">
                    <div class="flex space-x-4">
                        <!-- Current: "bg-indigo-700 dark:bg-indigo-950/40 text-white", Default: "text-white hover:bg-indigo-500/75 dark:hover:bg-indigo-700/75" -->
                        {{ _self.menu_section_link(current_menu_section | default("unknown"), 'dashboard', 'admin_home', "Dashboard") }}
                        {{ _self.menu_section_link(current_menu_section | default("unknown"), 'stripe_accounts', 'admin_stripe_list_accounts', "Stripe Accounts") }}
                        {{ _self.menu_section_link(current_menu_section | default("unknown"), 'discord_servers', 'admin_list_discord_servers', "Discord Servers") }}
                        {{ _self.menu_section_link(current_menu_section | default("unknown"), 'tenant_config', 'admin_tenant_config', "Configuration") }}

                    </div>
                </div>
            </div>
            <div class="flex lg:hidden">
                <!-- Mobile menu button -->
                <button type="button" command="--toggle" commandfor="mobile-menu" class="relative inline-flex items-center justify-center rounded-md bg-indigo-600 p-2 text-indigo-200 hover:bg-indigo-500/75 hover:text-white focus:outline-2 focus:outline-offset-2 focus:outline-white dark:bg-indigo-800 dark:hover:bg-indigo-700/75">
                    <span class="absolute -inset-0.5"></span>
                    <span class="sr-only">Open main menu</span>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-slot="icon" aria-hidden="true" class="size-6 in-aria-expanded:hidden">
                        <path d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-slot="icon" aria-hidden="true" class="size-6 not-in-aria-expanded:hidden">
                        <path d="M6 18 18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </button>
            </div>
            <div class="hidden lg:ml-4 lg:block">
                <div class="flex items-center">
                    <!-- Profile dropdown -->
                    <el-dropdown class="relative ml-3 shrink-0">
                        <button class="relative flex rounded-full focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white cursor-pointer">
                            <span class="absolute -inset-1.5"></span>
                            <span class="sr-only">Open user menu</span>

                            <img src="https://cdn.discordapp.com/avatars/{{ user.discordId.value }}/{{ user.avatar }}.png" alt="" class="size-8 rounded-full outline -outline-offset-1 outline-white/10" />
                            <span class="ml-2" aria-hidden="true">{{ user.globalName }} ({{ user.username}})</span>
                        </button>

                        <el-menu anchor="bottom end" popover class="w-48 origin-top-right rounded-md bg-white py-1 shadow-lg outline-1 outline-black/5 transition transition-discrete [--anchor-gap:--spacing(2)] data-closed:scale-95 data-closed:transform data-closed:opacity-0 data-enter:duration-100 data-enter:ease-out data-leave:duration-75 data-leave:ease-in dark:bg-gray-800 dark:-outline-offset-1 dark:outline-white/10">
{#                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 focus:bg-gray-100 focus:outline-hidden dark:text-gray-200 dark:focus:bg-white/5">Your profile</a>#}
{#                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 focus:bg-gray-100 focus:outline-hidden dark:text-gray-200 dark:focus:bg-white/5">Settings</a>#}
                            <a href="{{ path('admin_discord_disconnect') }}" class="block px-4 py-2 text-sm text-gray-700 focus:bg-gray-100 focus:outline-hidden dark:text-gray-200 dark:focus:bg-white/5">Sign out</a>
                        </el-menu>
                    </el-dropdown>
                </div>
            </div>
        </div>
    </div>

    <el-disclosure id="mobile-menu" hidden class="block lg:hidden">
        <div class="space-y-1 px-2 pt-2 pb-3">
            <!-- Current: "bg-indigo-700 dark:bg-indigo-950/40 text-white", Default: "text-white hover:bg-indigo-500/75 dark:hover:bg-indigo-700/75" -->
            {#                        <a href="#" aria-current="page" class="block rounded-md bg-indigo-700 px-3 py-2 text-base font-medium text-white dark:bg-indigo-950/40">Dashboard</a>#}
            {#                        <a href="#" class="block rounded-md px-3 py-2 text-base font-medium text-white hover:bg-indigo-500/75 dark:hover:bg-indigo-700/75">Team</a>#}
        </div>
        <div class="border-t border-indigo-700 pt-4 pb-3 dark:border-indigo-800">
            <div class="flex items-center px-5">
                <div class="shrink-0">
                    <img src="https://cdn.discordapp.com/avatars/{{ user.discordId.value }}/{{ user.avatar }}.png" alt="" class="size-10 rounded-full outline -outline-offset-1 outline-white/10" />
                </div>
                <div class="ml-3">
                    <div class="text-base font-medium text-white">{{ user.globalName }}</div>
                    <div class="text-sm font-medium text-indigo-300">{{ user.email }}</div>
                </div>
            </div>
            <div class="mt-3 space-y-1 px-2">
{#                <a href="#" class="block rounded-md px-3 py-2 text-base font-medium text-white hover:bg-indigo-500/75 dark:hover:bg-indigo-700/75">Your profile</a>#}
{#                <a href="#" class="block rounded-md px-3 py-2 text-base font-medium text-white hover:bg-indigo-500/75 dark:hover:bg-indigo-700/75">Settings</a>#}
                <a href="{{ path('admin_discord_disconnect') }}" class="block rounded-md px-3 py-2 text-base font-medium text-white hover:bg-indigo-500/75 dark:hover:bg-indigo-700/75">Sign out</a>
            </div>
        </div>
    </el-disclosure>
</nav>
